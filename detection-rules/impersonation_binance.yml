name: "Brand impersonation: Binance"
description: |
  Impersonation of the cryptocurrency exchange Binance.
type: "rule"
severity: "medium"
source: "type.inbound\nand (\n    strings.ilike(sender.display_name, '*binance*') \n    or strings.ilevenshtein(sender.display_name, 'binance') <= 1\n    or strings.ilike(sender.email.domain.domain, '*binance*')\n    or strings.ilike(subject.subject, '*binance*')\n)\nand sender.email.domain.root_domain not in~ ('binance.com', 'trustwallet.com', 'binance.charity')\nand any(ml.nlu_classifier(body.html.display_text).entities, .text == \"Binance\")\nand any(ml.nlu_classifier(body.html.display_text).entities, .name == \"financial\")\nand any(ml.nlu_classifier(body.html.display_text).entities, .name == \"urgency\")\nand (\n  any(ml.nlu_classifier(body.html.display_text).entities, .text in~ (\"withdrawal\", \"deposit\"))\n  or any(ml.nlu_classifier(body.html.display_text).intents, .name != \"benign\")\n)\nand (\n        // if this comes from a free email provider,\n        // flag if org has never sent an email to sender's email before\n        (\n            sender.email.domain.root_domain in $free_email_providers\n            and sender.email.email not in $recipient_emails\n        )\n        // if this comes from a custom domain,\n        // flag if org has never sent an email to sender's domain before\n        or (\n            sender.email.domain.root_domain not in $free_email_providers\n            and sender.email.domain.domain not in $recipient_domains\n        )\n)\n"
tags:
  - "Brand impersonation"
  - "Suspicious sender"
testing_pr: 576
testing_sha: 97e1ad36cea48ee023b2d47239f7ef803a2df522
