name: "Reconaissance: Suspicious indicators with no links, attachments, and a short body"
description: "Email contains suspicious indicators, no links or attachments, and a short or blank body, indicating possible deliverability or recipient infrastructure testing."
type: "rule"
severity: "low"
source: "type.inbound\nand (\n  (\n    (\n      length(recipients.to) > 2\n      and all(recipients.to, .email.domain.domain not in $org_domains)\n    )\n    or (\n        length(subject.subject) == 0 \n        and length(body.plain.raw) < 50 \n        and headers.date_original_offset in (\"0\", \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\")\n    )\n    or length(body.plain.raw) < 3\n  )\n  or length(recipients.bcc) > 0\n  or any(recipients.to, .display_name == \"undisclosed-recipients\")\n)\nand length(subject.subject) < 20\nand length(body.links) == 0\nand length(attachments) == 0\nand (\n  length(body.current_thread.text) < 50\n  or length(body.plain.raw) < 50\n  or length(body.html.display_text) < 50\n)\nand profile.by_sender().prevalence != \"common\"\n"
tags:
  - "Attack surface reduction"
attack_types:
  - "Spam"
detection_methods:
  - "Content analysis"
  - "Header analysis"
  - "Sender analysis"
id: "7f479c27-cfa5-5995-aa37-58b28a4bbf56"
testing_pr: 1072
testing_sha: 394dec422b17a03445de02015588ad395162449e
