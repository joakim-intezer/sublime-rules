name: "Attachment: PowerPoint with suspicious hyperlink"
description: |
  Attached PowerPoint contains a suspicious hyperlink that can execute arbitrary code.
references:
  - "https://twitter.com/doc_guard/status/1570190610774257665"
type: "rule"
severity: "high"
source: "type.inbound\nand any(attachments, (.file_extension in~ (\"ppt\", \"pptx\"))\n    and any(file.explode(.),\n        any(.scan.exiftool.fields, .key == \"Hyperlinks\" \n            and (\n                4 of (\n                    strings.ilike(.value, \"*[Convert]::ToChar*\"),\n                    strings.ilike(.value, \"*vbs*\"),\n                    strings.ilike(.value, \"*[IO.File]::Create*\"),\n                    strings.ilike(.value, \"*[IO.File]::Exists*\"),\n                    strings.ilike(.value, \"*[io.FileOPtions]::DeleteOnClose*\"),\n                    strings.ilike(.value, \"*Net.WebClient*\"),\n                    strings.ilike(.value, \"*dll*\"),\n                )\n        )\n    )\n))\n"
tags:
  - "Suspicious attachment"
  - "Suspicious link"
  - "Office exploit"
testing_pr: 384
testing_sha: 0de0cfdb39b02a5acc3b1ecdbc6d31095def30a9
