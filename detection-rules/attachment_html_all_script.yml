name: "Attachment: HTML file contains exclusively Javascript"
description: |
  Attached HTML file does not contain any HTML other than a <script> block.
references:
type: "rule"
severity: "medium"
source: "type.inbound \nand any(attachments,\n    (\n        .file_extension in~ (\"html\", \"htm\", \"shtml\", \"dhtml\") or\n        .file_extension in~ $file_extensions_common_archives or\n        .file_type == \"html\"\n    )\n    and any(file.explode(.), \n        length(.scan.strings.strings) == 1\n        and any(.scan.strings.strings, \n            strings.starts_with(., \"<script>\")\n        )\n        and any(.scan.strings.strings, \n            strings.ends_with(., \"</script>\")\n        )\n    )\n)\n"
tags:
  - "Suspicious attachment"
  - "HTML smuggling"
testing_pr: 586
testing_sha: 867fb7f9c71f2edf725ef209523400218b651b4f
