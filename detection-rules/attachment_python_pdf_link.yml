name: "Attachment: Python generated PDF with link"
description: |
  The PDF attachment was created with a Python-based script. The PDF attachment also contains one or more links. These techniques were used by PikaBot, among others.
references:
  - Internal Research
authors:
  - twitter: "affje0x65"
type: "rule"
severity: "medium"
source: "type.inbound\n   // and profile.by_sender().prevalence in (\"new\", \"outlier\")\nand any(attachments,.file_extension == \"pdf\" and\n   any(file.explode(.),\n   any(.scan.strings.strings, \n        // create the raw PDF from code with this tools\n        strings.ilike(., \"*ReportLab*\", \"*pypdf*\", \"*pypdf2\", \"*pikepdf*\", \"*PyMuPDF*\", \"*IronPDF*\")\n        // create an intermediate format and convert it to PDF\n        or strings.ilike(., \"*pdfkit*\", \"*xhtml2pdf*\", \"*pdflatex*\")\n        // image to pdf\n        or strings.ilike(., \"*img2pdf*\", \"*sphinxcontrib-svg2pdfconverter*\")\n    )\n) and any(file.explode(.),\n     length(.scan.url.urls) < 0\n    )      \n) \n"
tactics_and_techniques:
  - "Evasion"
  - "PDF"
detection_methods:
  - "File analysis"
id: "2fec884d-71f4-58ae-82ce-e3ca5bf65109"
testing_pr: 1283
testing_sha: 28c90dcaf51f2c52e09fa2a424d9d22f30b1735e
