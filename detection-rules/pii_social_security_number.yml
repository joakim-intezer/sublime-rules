name: "PII: Social Security Number"
description: "This rule detect potential PII leakage by detecting multiple patterns and verbiage indicative of a Social Security Number (SSN) within a message body. "
type: "rule"
severity: "medium"
source: |
  (type.inbound or type.outbound)
  // social security number:
  // 'ssn' or 'social' followed by patterns capturing 
  // xxxxxxxxx, xxx-xx-xxxx, xx-xxxxxx
  and regex.icontains(body.current_thread.text,
                      '\b(SSN\b|Social\b).{0,30}(\d{9}\d?|\d{3}-\d{2}-\d{4}|\d{2}-\d{7})\b'
  )

tags:
  - "PII"
id: "059fbe6d-1291-5322-bf84-5919e044f979"
