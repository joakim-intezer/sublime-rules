name: "Attachment: ICS with embedded document"
description: |
  ICS invite contains an embedded document.
references:
  - "https://delivr.to/payloads?id=2212f8db-5a21-4b36-a15e-4097adbc136d"
type: "rule"
severity: "low"
source: "type.inbound \nand any(attachments, .file_extension == \"ics\"\n    and any(file.explode(.), \n        any(.scan.strings.strings, strings.ilike(., '*ATTACH;ENCODING=*;VALUE=BINARY*'))\n        and 1 of (\n            any(.scan.strings.strings, strings.ilike(., '*FILENAME=*.doc*')),\n            any(.scan.strings.strings, strings.ilike(., '*FILENAME=*.dot*')),\n            any(.scan.strings.strings, strings.ilike(., '*FILENAME=*.pp*')),\n            any(.scan.strings.strings, strings.ilike(., '*FILENAME=*.wbk*')),\n            any(.scan.strings.strings, strings.ilike(., '*FILENAME=*.xl*')),\n        )\n    )\n)\n"
tags:
  - "Suspicious attachment"
testing_pr: 564
testing_sha: 876ad7f3dec288e9973c4de7f163dd282353f786
