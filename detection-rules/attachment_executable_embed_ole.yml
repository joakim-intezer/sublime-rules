name: "Attachment: Executable embedded as an OLE object"
description: |
  OLE2 (eg. Microsoft Office) attachment with an embedded executable.
references:
  - "https://delivr.to/payloads?id=a75bb3ed-810e-4424-9307-7913343d0f68"
type: "rule"
severity: "high"
source: "type.inbound \n    and any(attachments,\n        (\n            strings.ilike(.file_extension, \"accd*\", \"doc*\", \"mdb\", \"odt\", \"ppt*\", \"wbk\", \"xls*\")\n        )\n        and any(file.explode(.), \n            .file_extension in~ (\"action\", \"apk\", \"app\", \"appimage\", \"applescript\", \"bat\", \"cab\", \"cmd\", \"com\", \"command\", \"cpl\", \"dll\", \"dmg\", \"exe\", \"gadget\", \"hta\", \"inf\", \"ins\", \"ipa\", \"isu\", \"jar\", \"job\", \"js\", \"jse\", \"lnk\", \"msi\", \"msp\", \"paf\", \"pif\", \"ps1\", \"rgs\", \"run\", \"scr\", \"sct\", \"sh\", \"shb\", \"shortcut\", \"vb\", \"vbe\", \"vbs\")\n            or any(.flavors.yara, . == 'base64_pe')\n    )\n)\n"
tags:
  - "Suspicious attachment"
attack_types:
  - "Malware/Ransomware"
tactics_and_techniques:
  - "Evasion"
  - "Scripting"
detection_methods:
  - "File analysis"
  - "YARA"
id: "423517c2-2542-5091-948b-118ba987d8b7"
testing_pr: 193
testing_sha: c4dcd96b7d78e54c27bf614b49f2e4739de6dce1
