name: "File sharing link with a suspicious subject"
description: "A file sharing link in the body with a common BEC subject. This rule could be expanded to \ninclude additional BEC subjects.\n"
type: "rule"
severity: "medium"
source: "type.inbound\nand sender.email.domain.root_domain != 'google.com'\nand any(body.links, \n  .href_url.domain.domain in $free_file_hosts\n  and not (\n      // negating Google Forms links\n      .href_url.domain.domain == \"docs.google.com\"\n      and strings.istarts_with(.href_url.path, \"/forms/\")\n  )\n)\nand regex.icontains(subject.subject, 'immediately', 'urgent')\nand any(ml.nlu_classifier(body.current_thread.text).intents, .name != \"benign\")\nand (\n  not profile.by_sender().solicited\n  or (\n    profile.by_sender().any_messages_malicious_or_spam\n    and not profile.by_sender().any_false_positives\n  )\n)\n"
attack_types:
  - "BEC/Fraud"
tactics_and_techniques:
  - "Free file host"
  - "Social engineering"
detection_methods:
  - "Header analysis"
  - "Sender analysis"
  - "URL analysis"
id: "a306e2a6-addc-5e26-9be1-c146f37fd7f2"
testing_pr: 815
testing_sha: aed114f25899ab2d1ff2b5519c78aa177a48fa26
