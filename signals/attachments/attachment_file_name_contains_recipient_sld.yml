name: "Attachment: File Name Contains Recipient SLD"
type: "query"
source: |
  and any(attachments,
        any(recipients.to,
            strings.icontains(..file_name, .email.domain.sld)

            // make sure it's an impersonation
            // avoids scenarios where the sender cc's someone
            // on their own domain, and the sender includes
            // their own org name in the file name
            and .email.domain.sld != sender.email.domain.sld
        )
  )
